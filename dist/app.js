!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=4)}([function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unitStep=function(e){if(e<0)return 0;if(e>=0)return 1},t.get1DPosition=function(e,t,a){return t+a*e},t.getCoordinate=function(e,t){return{x:t%e,y:Math.floor(t/e)}},t.valuesArray=function(e,t){for(var a=[],n=0,r=e.length;n<r;n++)e[n].hasOwnProperty(t)&&a.push(e[n][t]);return a};var n=t.FACE_WIDTH=180,r=t.FACE_HEIGHT=180,i=(t.CAMERA_WIDTH=640,t.CAMERA_HEIGHT=480,t.CANVAS_WIDTH=480),o=t.CANVAS_HEIGHT=480,u=t.CAPTURE_HEIGHT=180,c=t.CAPTURE_WIDTH=180;t.FACE_FRAME=[(i-n)/2,(o-r)/2,n,r],t.POINT_8=8,t.RADIUS_1=1,t.RADIUS_2=2,t.RGBA_SHIFT=4,t.NEIGHBOUR_SHIFT=3,t.WEIGHT_BLOCK=[.15,.08,.15,.08,.15,.08,.08,.15,.08],t.UNIFORM_BINARY_PATTERN=["non",0,1,2,3,4,6,7,8,12,14,15,16,24,28,30,31,32,48,56,60,62,63,64,96,112,120,124,126,127,128,129,131,135,143,159,191,192,193,195,199,207,223,224,225,227,231,239,240,241,243,247,248,249,251,252,253,254,255],t.BLOCK_9_BY_9=[[0,0,c/3+1,u/3+1],[c/3-1,0,c/3+2,u/3+1],[2*c/3-1,0,c+1,u/3+1],[0,u/3-1,c/3+1,u/3+2],[c/3-1,u/3-1,c/3+2,u/3+2],[2*c/3-1,u/3-1,c+1,u/3+2],[0,2*u/3-1,c/3+1,u/3+1],[c/3-1,2*u/3-1,c/3+2,u/3+1],[2*c/3-1,2*u/3-1,c+1,u/3+1]],t.CHI_RECOGNITION_DOF=.02,t.CHI_RECOGNITION_BLOCKS_DOF=.05,t.CHI_PREDICTION_DOF=.1},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=c(a(3)),i=a(8),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(0)),u=c(a(2));function c(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"getImageData",value:function(e){for(var t,a=arguments.length,n=Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];return 4===n.length?(t=e.getContext("2d")).getImageData.apply(t,n):e.getContext("2d").getImageData(0,0,e.width,e.height)}},{key:"rgb2gray",value:function(e){for(var t=0,a=e.length;t<a;t+=4)e[t]=e[t+1]=e[t+2]=.3*e[t]+.59*e[t+1]+.11*e[t+2];return e}},{key:"rgbCanvas2grey",value:function(e){var t=this.getImageData(e);return this.rgb2gray(t.data)}},{key:"getPixelValue",value:function(e,t,a){return e.getImageData(t,a,1,1).data[0]}},{key:"extract8PointRadius1Feature",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=e.getContext("2d"),n=this.getImageData(e),r=n.data,i=n.data.slice(),u=1;u<e.height-1;u++)for(var c=1,s=0;c<e.width-1;c++,s+=4){var l=0,f=[],d=o.get1DPosition(e.width,c,u)*o.RGBA_SHIFT,h=this.getGrayScaleValue(i,d);f[7]=this.getGrayScaleValue(i,o.get1DPosition(e.width,c-t,u-t)*o.RGBA_SHIFT)-h,f[6]=this.getGrayScaleValue(i,o.get1DPosition(e.width,c,u-t)*o.RGBA_SHIFT)-h,f[5]=this.getGrayScaleValue(i,o.get1DPosition(e.width,c+t,u-t)*o.RGBA_SHIFT)-h,f[4]=this.getGrayScaleValue(i,o.get1DPosition(e.width,c+t,u)*o.RGBA_SHIFT)-h,f[3]=this.getGrayScaleValue(i,o.get1DPosition(e.width,c+t,u+t)*o.RGBA_SHIFT)-h,f[2]=this.getGrayScaleValue(i,o.get1DPosition(e.width,c,u+t)*o.RGBA_SHIFT)-h,f[1]=this.getGrayScaleValue(i,o.get1DPosition(e.width,c-t,u+t)*o.RGBA_SHIFT)-h,f[0]=this.getGrayScaleValue(i,o.get1DPosition(e.width,c-t,u)*o.RGBA_SHIFT)-h;for(var v=0,g=f.length;v<g;v++)l+=o.unitStep(f[v])*Math.pow(2,v);r[d]=r[d+1]=r[d+2]=l}a.clearRect(0,0,e.width,e.height),a.putImageData(n,0,0)}},{key:"getGrayScaleValue",value:function(e,t){return.3*e[t]+.59*e[t+1]+.11*e[t+2]}},{key:"evaluateRecognition",value:function(e){this.extract8PointRadius1Feature(e);for(var t={value:1,name:"Unknown"},a=[],n=0,c=o.BLOCK_9_BY_9.length;n<c;n++)a=a.concat(o.valuesArray(u.default.uniformBinary(this.getImageData.apply(this,[e].concat(s(o.BLOCK_9_BY_9[n])))),"normalized"));if(this.compareWithData(a,Object.assign({},r.default.get("data"),i.FACE_DATA),"blocks",t),t.value<o.CHI_RECOGNITION_BLOCKS_DOF)return t}},{key:"compareWithData",value:function(e,t,a,n){for(var r in t)if(t.hasOwnProperty(r)){var i=u.default.compareHistogram(e,t[r][a]);i<n.value&&(n.name=r,n.value=i)}}}]),e}();t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=u(a(3)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(0)),o=u(a(1));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"init",value:function(e){for(var t=[],a=0,n=e.length;a<n;a++)t.push({bin:e[a],frequency:0,normalized:0});return t}},{key:"uniformBinary",value:function(e){for(var t=e.data,a=this.init(i.UNIFORM_BINARY_PATTERN),n=0,r=t.length;n<r;n+=4){for(var o=!0,u=1,c=i.UNIFORM_BINARY_PATTERN.length;u<c;u++)if(i.UNIFORM_BINARY_PATTERN[u]===t[n]){this.incrementHistogramFrequency(a,u,r),o=!1;break}o&&this.incrementHistogramFrequency(a,0,r)}return a}},{key:"incrementHistogramFrequency",value:function(e,t,a){e[t].frequency++,e[t].normalized=e[t].frequency/(a/4)}},{key:"compareHistogram",value:function(e,t){return this.weightedChiSquare(e,t)}},{key:"chiSquare",value:function(e,t){for(var a=e.length,n=0,r=0;r<a;r++)n+=Math.pow(e[r]-t[r],2)/t[r];return n}},{key:"weightedChiSquare",value:function(e,t){for(var a=e.length,n=0,r=0,o=0;r<a;r++)o=Math.floor(r/i.UNIFORM_BINARY_PATTERN.length),n+=i.WEIGHT_BLOCK[o]*Math.pow(e[r]-t[r],2)/(e[r]+t[r]);return n}},{key:"isNormalized",value:function(e,t){for(var a=0,n=0,r=1;r<e.length;r++)a+=e[r].frequency,n+=e[r].normalized;return a===t/4&&1===Math.round(n)}},{key:"generateHistogramValue",value:function(t,a){var n={},u=[];r.default.has()&&(n=r.default.get("data"));for(var s=0,l=i.BLOCK_9_BY_9.length;s<l;s++)u=u.concat(i.valuesArray(e.uniformBinary(o.default.getImageData.apply(o.default,[t].concat(c(i.BLOCK_9_BY_9[s])))),"normalized"));n[a]={area:i.valuesArray(this.uniformBinary(o.default.getImageData(t)),"normalized"),blocks:u},r.default.put("data",n)}}]),e}();t.default=s},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"has",value:function(){return!!sessionStorage.length}},{key:"put",value:function(e,t){sessionStorage[e]=JSON.stringify(t)}},{key:"get",value:function(e,t){return this.has()?void 0===t?JSON.parse(sessionStorage[e]):JSON.parse(sessionStorage[e])[t]:null}}]),e}();t.default=r},function(e,t,a){a(5),e.exports=a(9)},function(e,t,a){"use strict";var n,r=a(6),i=(n=r)&&n.__esModule?n:{default:n};i.default.createWithImage("camera","images/lenna.png");var o=i.default.createById("camera"),u=document.querySelector("#webCam .fa");document.getElementById("webCam").addEventListener("click",function(){o.webcam.isActive?(o.stopWebCam(),u.setAttribute("class","fa fa-play fa-2x")):(o.startWebCam(),u.setAttribute("class","fa fa-pause fa-2x"))}),document.getElementById("capture").addEventListener("click",function(){if(o.webcam.isActive){var e=document.querySelector(".name input");o.stopWebCam(),u.setAttribute("class","fa fa-play fa-2x"),e.style.display="block",e.onkeydown=function(t){13===t.keyCode&&(o.capture(e.value),e.style.display="none",e.value="")}}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=u(a(7)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(0)),o=u(a(1));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.width=this.canvas.width,this.height=this.canvas.height,this.capturedCanvas=document.getElementById("capturedImage"),this.capturedCanvas.width=i.CAPTURE_WIDTH,this.capturedCanvas.height=i.CAPTURE_HEIGHT,this.webcam=new r.default(this.canvas,this.capturedCanvas)}return n(e,[{key:"startWebCam",value:function(){return this.webcam.start()}},{key:"stopWebCam",value:function(){return this.webcam.stop()}},{key:"capture",value:function(e){this.webcam.capture(e)}},{key:"browseImage",value:function(e){var t=this,a=new Image;a.src=e,a.onload=function(){var e=i.CAPTURE_WIDTH/a.width,n=t.capturedCanvas.getContext("2d");n.clearRect(0,0,i.CAPTURE_WIDTH,i.CAPTURE_HEIGHT),n.drawImage(a,0,(i.CAPTURE_HEIGHT-a.height*e)/2,i.CAPTURE_WIDTH,a.height*e),o.default.extract8PointRadius1Feature(t.capturedCanvas)}}},{key:"handleLocalFile",value:function(e){e.type.match(/image.*/)&&this.browseImage(window.URL.createObjectURL(new Blob(e,{type:"application/zip"})))}}],[{key:"createById",value:function(t){var a=document.getElementById(t);return a.height=i.CANVAS_HEIGHT,a.width=i.CANVAS_WIDTH,new e(a)}},{key:"createWithImage",value:function(t,a){var n=e.createById(t);return n.browseImage(a),n}}]),e}();t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(0)),i=u(a(2)),o=u(a(1));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scaleV=1,this.scaleH=-1,this.stream="",this.isActive=!1,this.cameraTimeout="",this.video=document.createElement("video"),this.canvas=t,this.capturedCanvas=a,this.context=this.canvas.getContext("2d"),this.capturedContext=this.capturedCanvas.getContext("2d")}return n(e,[{key:"start",value:function(){var e=this;void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise(function(a,n){t.call(navigator,e,a,n)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(a){e.stream=a,"srcObject"in e.video?e.video.srcObject=a:e.video.src=window.URL.createObjectURL(a),e.video.onloadedmetadata=function(){return e.video.play()},e.isActive=!0,t()}).catch();var t=function t(){e.flipHorizontal(),e.drawRecognitionFrame(),e.capturedContext.drawImage(e.canvas,(r.CANVAS_WIDTH-r.FACE_WIDTH)/2,(r.CANVAS_HEIGHT-r.FACE_HEIGHT)/2,r.FACE_WIDTH,r.FACE_HEIGHT,0,0,e.capturedCanvas.width,e.capturedCanvas.height),e.cameraTimeout=setTimeout(t,100,e.video,e.context),e.drawOutput(o.default.evaluateRecognition(e.capturedCanvas))}}},{key:"stop",value:function(){clearTimeout(this.cameraTimeout),this.stream.getTracks()[0].stop(),this.isActive=!1}},{key:"capture",value:function(e){var t;this.capturedContext.clearRect(0,0,this.capturedCanvas.width,this.capturedCanvas.height),(t=this.capturedContext).drawImage.apply(t,[this.canvas].concat(function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}(r.FACE_FRAME),[0,0,this.capturedCanvas.width,this.capturedCanvas.height])),o.default.extract8PointRadius1Feature(this.capturedCanvas),i.default.generateHistogramValue(this.capturedCanvas,e)}},{key:"flipHorizontal",value:function(){var e=(1===this.scaleH?0:-1*r.CANVAS_WIDTH)+(r.CANVAS_WIDTH-r.CAMERA_WIDTH)/2,t=(1===this.scaleV?0:-1*r.CANVAS_HEIGHT)+(r.CANVAS_HEIGHT-r.CAMERA_HEIGHT)/2;this.context.save(),this.context.scale(this.scaleH,this.scaleV),this.context.drawImage(this.video,e,t),this.context.restore()}},{key:"drawRecognitionFrame",value:function(){this.context.beginPath(),this.context.moveTo(r.FACE_FRAME[0],r.FACE_FRAME[1]),this.context.lineTo(r.FACE_FRAME[0]+r.FACE_FRAME[2],r.FACE_FRAME[1]),this.context.lineTo(r.FACE_FRAME[0]+r.FACE_FRAME[2],r.FACE_FRAME[1]+r.FACE_FRAME[3]),this.context.lineTo(r.FACE_FRAME[0],r.FACE_FRAME[1]+r.FACE_FRAME[3]),this.context.lineTo(r.FACE_FRAME[0],r.FACE_FRAME[1]),this.context.stroke(),this.context.closePath()}},{key:"drawOutput",value:function(e){void 0!==e&&(this.context.textAlign="center",this.context.font="bold 20pt Calibri",this.context.fillStyle="#ffffff",this.context.fillText("You're",this.canvas.width/2,this.canvas.height/2-20),this.context.fillText(e.name,this.canvas.width/2,this.canvas.height/2+20))}}]),e}();t.default=c},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FACE_DATA={}},function(e,t){}]);
//# sourceMappingURL=app.js.map